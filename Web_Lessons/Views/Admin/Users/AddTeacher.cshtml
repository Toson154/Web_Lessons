@model Web_Lessons.ViewModels.AddTeacherViewModel
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Add Teacher";
    ViewData["Description"] = "Create new teacher account";
}

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="content-card">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4>Add New Teacher</h4>
                <a asp-action="Users" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i>Back to Users
                </a>
            </div>

            @if (ViewData.ModelState.ErrorCount > 0)
            {
                <div class="alert alert-danger">
                    <h5><i class="fas fa-exclamation-triangle me-2"></i>Please fix the following errors:</h5>
                    <ul class="mb-0">
                        @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                        {
                            <li>@error.ErrorMessage</li>
                        }
                    </ul>
                </div>
            }

            <form asp-action="AddTeacher" method="post" id="addTeacherForm">
                @Html.AntiForgeryToken()

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label asp-for="FullName" class="form-label">Full Name *</label>
                        <input asp-for="FullName" class="form-control" placeholder="Enter teacher's full name" />
                        <span asp-validation-for="FullName" class="text-danger small"></span>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label asp-for="Email" class="form-label">Email Address *</label>
                        <input asp-for="Email" type="email" class="form-control" placeholder="teacher@example.com" />
                        <span asp-validation-for="Email" class="text-danger small"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label asp-for="Password" class="form-label">Password *</label>
                        <input asp-for="Password" type="password" class="form-control" placeholder="Create a strong password" />
                        <div class="form-text small">
                            Must be at least 6 characters
                        </div>
                        <span asp-validation-for="Password" class="text-danger small"></span>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label asp-for="ConfirmPassword" class="form-label">Confirm Password *</label>
                        <input asp-for="ConfirmPassword" type="password" class="form-control" placeholder="Confirm the password" />
                        <span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
                    </div>
                </div>

                <div class="d-flex justify-content-between mt-4">
                    <a asp-action="Users" class="btn btn-outline-secondary">
                        <i class="fas fa-times me-2"></i>Cancel
                    </a>
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <i class="fas fa-user-plus me-2"></i>Create Teacher Account
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>

    <script>
        $(document).ready(function () {
            console.log("Add Teacher page loaded");

            // Form submission handling
            $('#addTeacherForm').on('submit', function (e) {
                const btn = $('#submitBtn');
                btn.prop('disabled', true);
                btn.html('<i class="fas fa-spinner fa-spin me-2"></i>Creating...');
            });

            // Password strength indicator
            $('#Password').on('keyup', function () {
                const password = $(this).val();
                updatePasswordStrength(password);
            });

            function updatePasswordStrength(password) {
                const strengthBar = $('#passwordStrength');
                if (!strengthBar.length) {
                    $('#Password').after('<div id="passwordStrength" class="mt-2"></div>');
                }

                let score = 0;
                if (password.length >= 6) score++;
                if (password.length >= 8) score++;
                if (/[A-Z]/.test(password)) score++;
                if (/[0-9]/.test(password)) score++;
                if (/[^A-Za-z0-9]/.test(password)) score++;

                const colors = ['danger', 'warning', 'info', 'primary', 'success'];
                const texts = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong'];
                const color = colors[score] || 'danger';
                const text = texts[score] || 'Very Weak';
                const width = Math.min(100, (score / 5) * 100);

                $('#passwordStrength').html(`
                            <div class="progress" style="height: 5px;">
                                <div class="progress-bar bg-${color}" style="width: ${width}%"></div>
                            </div>
                            <small class="text-${color}">${text}</small>
                        `);
            }
        });
    </script>
}